
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">
<title>Layer List Dijit</title>
<link rel="stylesheet" href="http://js.arcgis.com/3.14/dijit/themes/claro/claro.css">
<link rel="stylesheet" href="http://js.arcgis.com/3.14/esri/css/esri.css">
<link rel="stylesheet" href="css/InfoWindow.css">

<style>
html, body, .container, #map {
    height:100%;
    width:100%;
    margin:0;
    padding:0;
    margin:0;
    font-family: "Open Sans";
}
#map {
    padding:0;
}
#layerListPane{
    width:25%;
}
.esriLayer{
  background-color: #fff;
}
.esriLayerList .esriList{
    border-top:none;
}
.esriLayerList .esriTitle {
  background-color: #fff;
  border-bottom:none;
}
.esriLayerList .esriList ul{
  background-color: #fff;
}
</style>
<script>var dojoConfig = { parseOnLoad: true , packages: [{
          "name": "components",
          "location": location.pathname.replace(/\/[^/]+$/, "") + "/components"
        }]};</script>
<script src="http://js.arcgis.com/3.14/"></script>
<script>
require([
     "dojo/dom",
      "dojo/dom-construct",
      "esri/map", 
      "../components/InfoWindow.js",
      "esri/layers/FeatureLayer",
      "esri/InfoTemplate",
      "dojo/string",
    "esri/arcgis/utils",
    "esri/dijit/LayerList",
    "dijit/layout/BorderContainer", 
    "dijit/layout/ContentPane",
    "dojo/domReady!"
], function(
     dom,
       domConstruct,
       Map,
       InfoWindow,
       FeatureLayer,
       InfoTemplate,
       string,
    arcgisUtils,
    LayerList
) {
    
     //create the custom info window specifying any input options
       var infoWindow = new  InfoWindow({
          domNode: domConstruct.create("div", null, dom.byId("map"))
       });

      //create the map and specify the custom info window as the info window that will
      //be used by the map 

      var map = new Map("map", {
        center: [-118.243683, 34.052235],
        zoom: 10,
        basemap: "topo",
        infoWindow: infoWindow
      });
      
       //define the info template that is used to display the popup content. 
      var template = new InfoTemplate();
      template.setTitle("<b>${category}</b>");
      template.setContent(getTextContent);

      //create the feature layer
      var featureLayer = new FeatureLayer("http://services6.arcgis.com/IjlJ3SNhNad1djSr/arcgis/rest/services/Water_Wastage/FeatureServer/0",{
        infoTemplate: template,
        outFields: ["*"]
      });
      map.addLayer(featureLayer);

      //resize the info window 
      map.infoWindow.resize(300, 300);


      
      function getTextContent(graphic){
        var attr = graphic.attributes;
        console.log(attr);
        return "<b>" + attr.category + "</b><br /><h2>Date: </h2><p>"+new Date(attr.date).toUTCString()+"<h2>Description: <p>"+attr.description+"</p><img src='http://static.indianexpress.com/m-images/M_Id_408311_water.jpg'><button>Publish</button>";
      }
        var myWidget = new LayerList({
           map: map,
           layers: arcgisUtils.getLayerList(response) 
        },"layerList");
        myWidget.startup();

});
</script>
</head>
<body class="claro">
<div class="container" data-dojo-type="dijit/layout/BorderContainer" 
data-dojo-props="design:'headline',gutters:false">
<div id="layerListPane" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'right'">
    <div id="layerList"></div>
</div>
<div id="map" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'center'"></div>
</div>
</body>
</html> 
